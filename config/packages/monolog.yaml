when@dev:
    monolog:
        handlers:
            main:
                type: stream
                path: "%kernel.logs_dir%/%kernel.environment%.log"
                level: debug
                channels: ["!event"]
            flash:
                type: service
                id: ems_core.core_ui.flash_message_logger
                channels: [app,core,audit]
            doctrine:
                type: service
                id: ems_common.monolog.doctrine
                channels: [app,core,audit]
            console:
                type:   console
                process_psr_3_messages: false
                channels: ["!event", "!doctrine", "!console"]

when@prod: &monolog_prod
    monolog:
        handlers:
            main:
                type: fingers_crossed
                action_level: error
                handler: nested
                excluded_404s:
                    # regex: exclude all 404 errors from the logs
                    - ^/
            flash:
                type: service
                id: ems_core.core_ui.flash_message_logger
                channels: [ app,core,audit ]
            doctrine:
                type: service
                id: ems_common.monolog.doctrine
                channels: [ app,core,audit ]
            nested:
                type: stream
                path: "%kernel.logs_dir%/%kernel.environment%.log"
                level: debug
            console:
                type: console
                process_psr_3_messages: false
                channels: [ "!event", "!doctrine" ]

when@redis: *monolog_prod
when@db: *monolog_prod

when@test:
    monolog:
        handlers:
            main:
                type: stream
                path: "%kernel.logs_dir%/%kernel.environment%.log"
                level: debug
                channels: [ "!event" ]